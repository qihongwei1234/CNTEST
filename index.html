<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰å­—è¯†å­—èƒ½åŠ›æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
            margin: 20px 0;
            font-size: 24px;
        }
        .container {
            width: 90%;
            max-width: 600px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        form div {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin: 5px 0;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .result {
            text-align: center;
            margin-top: 20px;
            white-space: pre-wrap; /* æ”¯æŒæ¢è¡Œ */
        }
    </style>
</head>
<body>
    <h1>æ±‰å­—è¯†å­—èƒ½åŠ›æµ‹è¯•</h1>
    <div class="container">
        <form id="testForm">
            <div id="questions"></div>
            <button type="button" id="submitButton" onclick="submitTest()">æäº¤</button>
        </form>
        <div id="result" class="result"></div>
    </div>

    <script>
        // æ±‰å­—æ•°æ®ï¼ˆåŒ…å«å®Œæ•´å­—åº“ï¼‰
        const characterData = {
            "categories": [
                {"name": "æ•°å­—ä¸æ—¶é—´ç±»", "characters": ["ä¸€ yÄ«", "äºŒ Ã¨r", "ä¸‰ sÄn", "å›› sÃ¬", "äº” wÇ”", "å…­ liÃ¹", "ä¸ƒ qÄ«", "å…« bÄ", "ä¹ jiÇ”", "å shÃ­"]},
                {"name": "å®¶åº­ä¸äººç‰©ç±»", "characters": ["çˆ¸ bÃ ", "å¦ˆ mÄ", "å“¥ gÄ“", "å§ jiÄ›", "å¼Ÿ dÃ¬", "å¦¹ mÃ¨i", "çˆ· yÃ©", "å¥¶ nÇi", "çˆ¶ fÃ¹", "æ¯ mÇ”"]},
                {"name": "ç‰©å“ç±»", "characters": ["é—¨ mÃ©n", "çª— chuÄng", "æ¡Œ zhuÅ", "æ¤… yÇ", "åºŠ chuÃ¡ng", "ç¯ dÄ“ng", "ä¹¦ shÅ«", "æœ¬ bÄ›n", "ç¬” bÇ", "çº¸ zhÇ"]},
                {"name": "åŠ¨ä½œç±»", "characters": ["èµ° zÇ’u", "è·‘ pÇo", "è·³ tiÃ o", "åƒ chÄ«", "å– hÄ“", "çœ‹ kÃ n", "å¬ tÄ«ng", "è¯´ shuÅ", "å†™ xiÄ›", "è¯» dÃº"]},
                {"name": "è‡ªç„¶ç°è±¡ç±»", "characters": ["å¤© tiÄn", "åœ° dÃ¬", "æ—¥ rÃ¬", "æœˆ yuÃ¨", "æ˜Ÿ xÄ«ng", "äº‘ yÃºn", "é£ fÄ“ng", "é›¨ yÇ”", "é›· lÃ©i", "ç”µ diÃ n"]},
                {"name": "æŠ½è±¡æ¦‚å¿µç±»", "characters": ["å¤§ dÃ ", "å° xiÇo", "å¤š duÅ", "å°‘ shÇo", "é•¿ chÃ¡ng", "çŸ­ duÇn", "é«˜ gÄo", "ä½ dÄ«", "èƒ– pÃ ng", "ç˜¦ shÃ²u"]},
                {"name": "ç¤¾ä¼šä¸æ–‡åŒ–ç±»", "characters": ["å®¶ jiÄ", "æ ¡ xiÃ o", "åŸ chÃ©ng", "ä¹¡ xiÄng", "è¡— jiÄ“", "é“ dÃ o", "æ¡¥ qiÃ¡o", "æ¥¼ lÃ³u", "åº™ miÃ o", "å¯º sÃ¬"]},
                {"name": "åŠ¨ç‰©ä¸æ¤ç‰©ç±»", "characters": ["çŒ« mÄo", "ç‹— gÇ’u", "ç‰› niÃº", "ç¾Š yÃ¡ng", "é¸¡ jÄ«", "é¸­ yÄ", "é±¼ yÃº", "é¸Ÿ niÇo", "å…” tÃ¹", "é¼  shÇ”"]},
                {"name": "æ–¹ä½ä¸æ–¹å‘ç±»", "characters": ["ä¸Š shÃ ng", "ä¸‹ xiÃ ", "å·¦ zuÇ’", "å³ yÃ²u", "å‰ qiÃ¡n", "å hÃ²u", "é‡Œ lÇ", "å¤– wÃ i", "ä¸­ zhÅng", "è¾¹ biÄn"]},
                {"name": "å…¶ä»–å¸¸ç”¨å­—", "characters": ["æˆ‘ wÇ’", "ä½  nÇ", "ä»– tÄ", "å¥¹ tÄ", "å®ƒ tÄ", "è¿™ zhÃ¨", "é‚£ nÃ ", "è° shuÃ­", "å’Œ hÃ©", "ä¸ yÇ”"]}
            ]
        };

        // éšæœºç”Ÿæˆæµ‹è¯•é—®é¢˜ï¼ˆ20 é¢˜ï¼‰
        function generateQuestions() {
            const questionsDiv = document.getElementById('questions');
            let questionsHTML = '';
            const selectedChars = [];
            const categoryStats = {};

            // åˆå§‹åŒ–åˆ†ç±»ç»Ÿè®¡
            characterData.categories.forEach(category => {
                categoryStats[category.name] = { total: 0, correct: 0 };
            });

            // ä»æ¯ä¸ªåˆ†ç±»ä¸­éšæœºé€‰æ‹©è‡³å°‘ 1 ä¸ªå­—
            characterData.categories.forEach(category => {
                const chars = category.characters.sort(() => Math.random() - 0.5).slice(0, 1);
                selectedChars.push(...chars);
                categoryStats[category.name].total += chars.length;
            });

            // è¡¥å……å‰©ä½™çš„å­—ç¬¦ï¼Œç›´åˆ°æ€»æ•°ä¸º 20
            while (selectedChars.length < 20) {
                const randomCategory = characterData.categories[Math.floor(Math.random() * characterData.categories.length)];
                const randomChar = randomCategory.characters[Math.floor(Math.random() * randomCategory.characters.length)];
                if (!selectedChars.includes(randomChar)) {
                    selectedChars.push(randomChar);
                    categoryStats[randomCategory.name].total++;
                }
            }

            // æ‰“ä¹±é¡ºåº
            selectedChars.sort(() => Math.random() - 0.5);

            // ä¿å­˜é€‰ä¸­çš„é¢˜ç›®
            window.selectedChars = selectedChars;

            // ç”Ÿæˆé¢˜ç›®
            selectedChars.forEach((char, index) => {
                const [character, correctPinyin] = char.split(' ');
                const options = [correctPinyin];

                // æ·»åŠ  3 ä¸ªå¹²æ‰°é¡¹
                while (options.length < 4) {
                    const randomCategory = characterData.categories[Math.floor(Math.random() * characterData.categories.length)];
                    const randomChar = randomCategory.characters[Math.floor(Math.random() * randomCategory.characters.length)];
                    const [_, randomPinyin] = randomChar.split(' ');
                    if (!options.includes(randomPinyin)) {
                        options.push(randomPinyin);
                    }
                }

                // æ‰“ä¹±é€‰é¡¹é¡ºåº
                options.sort(() => Math.random() - 0.5);

                questionsHTML += `
                    <div>
                        <p>${index + 1}. è¯·é€‰æ‹©æ­£ç¡®çš„æ‹¼éŸ³ï¼š${character}</p>
                        ${options.map(option => `
                            <label>
                                <input type="radio" name="q_${index}" value="${option}">
                                ${option}
                            </label>
                        `).join('')}
                    </div>
                `;
            });

            questionsDiv.innerHTML = questionsHTML;
        }

        // æäº¤è¡¨å•å¹¶è®¡ç®—å¾—åˆ†
        function submitTest() {
            let score = 0;
            const totalQuestions = 20;
            const form = document.getElementById('testForm');
            const categoryStats = {};

            // åˆå§‹åŒ–åˆ†ç±»ç»Ÿè®¡
            characterData.categories.forEach(category => {
                categoryStats[category.name] = { total: 0, correct: 0 };
            });

            Array.from(form.elements).forEach(element => {
                if (element.type === 'radio' && element.checked) {
                    const questionIndex = element.name.split('_')[1];
                    const [character, correctPinyin] = window.selectedChars[questionIndex].split(' ');
                    const category = getCategoryForCharacter(character); // è·å–å­—ç¬¦æ‰€å±åˆ†ç±»
                    categoryStats[category].total++;
                    if (element.value === correctPinyin) {
                        score++;
                        categoryStats[category].correct++;
                    }
                }
            });

            const accuracy = (score / totalQuestions) * 100;

            // åŠ¨æ€ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
            const report = generateReport(categoryStats, totalQuestions, score);

            // æ˜¾ç¤ºæµ‹è¯•æŠ¥å‘Š
            document.getElementById('result').innerText = report;

            // ç¦ç”¨æäº¤æŒ‰é’®
            document.getElementById('submitButton').disabled = true;
        }

        // æ ¹æ®å­—ç¬¦è·å–æ‰€å±åˆ†ç±»
        function getCategoryForCharacter(character) {
            for (const category of characterData.categories) {
                if (category.characters.some(char => char.startsWith(character))) {
                    return category.name;
                }
            }
            return "æœªçŸ¥åˆ†ç±»";
        }

        // ç”Ÿæˆä¸ªæ€§åŒ–æµ‹è¯•æŠ¥å‘Š
        function generateReport(categoryStats, totalQuestions, correctCount) {
            const accuracy = (correctCount / totalQuestions) * 100;

            let report = `### æµ‹è¯•æŠ¥å‘Š ğŸ‰\n\n`;
            report += `**æ€»é¢˜æ•°ï¼š${totalQuestions}**\n`;
            report += `**æ­£ç¡®é¢˜æ•°ï¼š${correctCount}**\n`;
            report += `**æ­£ç¡®ç‡ï¼š${accuracy.toFixed(2)}%**\n\n`;

            // æ ¹æ®æ­£ç¡®ç‡è°ƒæ•´è¯­æ°”
            if (accuracy >= 80) {
                report += `å¤ªæ£’äº†ï¼ä½ çš„æ±‰å­—è¯†å­—èƒ½åŠ›éå¸¸å‡ºè‰²ï¼ğŸ‰\n`;
            } else if (accuracy >= 50) {
                report += `ä¸é”™å“¦ï¼ä½ å·²ç»æŒæ¡äº†ä¸å°‘å¸¸ç”¨æ±‰å­—ï¼Œç»§ç»­åŠ æ²¹ï¼ğŸ’ª\n`;
            } else {
                report += `åˆ«ç°å¿ƒï¼å­¦ä¹ æ±‰å­—æ˜¯ä¸€ä¸ªæ…¢æ…¢ç§¯ç´¯çš„è¿‡ç¨‹ï¼Œä½ å·²ç»è¿ˆå‡ºäº†é‡è¦çš„ä¸€æ­¥ï¼ğŸŒŸ\n`;
            }

            // åˆ†æåˆ†ç±»è¡¨ç°
            report += `\n#### ä½ çš„å¼ºé¡¹ ğŸ’ª\n`;
            for (const [category, stats] of Object.entries(categoryStats)) {
                if (stats.total > 0 && stats.correct / stats.total >= 0.7) {
                    report += `- **${category}**ï¼šä½ åœ¨è¿™ä¸ªåˆ†ç±»ä¸­è¡¨ç°å¾ˆæ£’ï¼Œç­”å¯¹äº† ${stats.correct}/${stats.total} é¢˜ï¼\n`;
                }
            }

            report += `\n#### éœ€è¦åŠ æ²¹çš„åœ°æ–¹ ğŸ’¡\n`;
            for (const [category, stats] of Object.entries(categoryStats)) {
                if (stats.total > 0 && stats.correct / stats.total < 0.7) {
                    report += `- **${category}**ï¼šè¿™ä¸ªåˆ†ç±»è¿˜éœ€è¦å¤šç»ƒä¹ å“¦ï¼Œç­”å¯¹äº† ${stats.correct}/${stats.total} é¢˜ã€‚\n`;
                }
            }

            // æä¾›å­¦ä¹ å»ºè®®
            report += `\n#### å­¦ä¹ å°å»ºè®® ğŸ¯\n`;
            report += `- å¤ä¹ è¿™æ¬¡æµ‹è¯•ä¸­ç­”é”™çš„é¢˜ç›®ï¼ŒæŠŠé‚£äº›æ±‰å­—å†™ä¸€å†™ã€è¯»ä¸€è¯»ã€‚\n`;
            report += `- æ¯å¤©å­¦ä¹ ä¸€ä¸ªåˆ†ç±»ï¼Œæ¯”å¦‚â€œè‡ªç„¶ç°è±¡ç±»â€å¯ä»¥ç»“åˆå¤©æ°”è§‚å¯Ÿæ¥è®°å¿†ã€‚\n`;
            report += `- æ‰¾ä¸€äº›ç®€å•çš„çŸ­æ–‡æˆ–æ•…äº‹ä¹¦æ¥è¯»ï¼Œé‡åˆ°ä¸è®¤è¯†çš„å­—å¯ä»¥æŸ¥ä¸€æŸ¥ã€‚\n`;

            return report;
        }

        // åˆå§‹åŒ–é¡µé¢
        window.onload = () => {
            generateQuestions();
        };
    </script>
</body
