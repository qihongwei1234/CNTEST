<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汉字识字能力测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
            margin: 20px 0;
            font-size: 24px;
        }
        .container {
            width: 90%;
            max-width: 600px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        form div {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin: 5px 0;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .result {
            text-align: center;
            margin-top: 20px;
            white-space: pre-wrap; /* 支持换行 */
        }
    </style>
</head>
<body>
    <h1>汉字识字能力测试</h1>
    <div class="container">
        <form id="testForm">
            <div id="questions"></div>
            <button type="button" id="submitButton" onclick="submitTest()">提交</button>
        </form>
        <div id="result" class="result"></div>
    </div>

    <script>
        // 汉字数据（包含完整字库）
        const characterData = {
            "categories": [
                {"name": "数字与时间类", "characters": ["一 yī", "二 èr", "三 sān", "四 sì", "五 wǔ", "六 liù", "七 qī", "八 bā", "九 jiǔ", "十 shí"]},
                {"name": "家庭与人物类", "characters": ["爸 bà", "妈 mā", "哥 gē", "姐 jiě", "弟 dì", "妹 mèi", "爷 yé", "奶 nǎi", "父 fù", "母 mǔ"]},
                {"name": "物品类", "characters": ["门 mén", "窗 chuāng", "桌 zhuō", "椅 yǐ", "床 chuáng", "灯 dēng", "书 shū", "本 běn", "笔 bǐ", "纸 zhǐ"]},
                {"name": "动作类", "characters": ["走 zǒu", "跑 pǎo", "跳 tiào", "吃 chī", "喝 hē", "看 kàn", "听 tīng", "说 shuō", "写 xiě", "读 dú"]},
                {"name": "自然现象类", "characters": ["天 tiān", "地 dì", "日 rì", "月 yuè", "星 xīng", "云 yún", "风 fēng", "雨 yǔ", "雷 léi", "电 diàn"]},
                {"name": "抽象概念类", "characters": ["大 dà", "小 xiǎo", "多 duō", "少 shǎo", "长 cháng", "短 duǎn", "高 gāo", "低 dī", "胖 pàng", "瘦 shòu"]},
                {"name": "社会与文化类", "characters": ["家 jiā", "校 xiào", "城 chéng", "乡 xiāng", "街 jiē", "道 dào", "桥 qiáo", "楼 lóu", "庙 miào", "寺 sì"]},
                {"name": "动物与植物类", "characters": ["猫 māo", "狗 gǒu", "牛 niú", "羊 yáng", "鸡 jī", "鸭 yā", "鱼 yú", "鸟 niǎo", "兔 tù", "鼠 shǔ"]},
                {"name": "方位与方向类", "characters": ["上 shàng", "下 xià", "左 zuǒ", "右 yòu", "前 qián", "后 hòu", "里 lǐ", "外 wài", "中 zhōng", "边 biān"]},
                {"name": "其他常用字", "characters": ["我 wǒ", "你 nǐ", "他 tā", "她 tā", "它 tā", "这 zhè", "那 nà", "谁 shuí", "和 hé", "与 yǔ"]}
            ]
        };

        // 随机生成测试问题（20 题）
        function generateQuestions() {
            const questionsDiv = document.getElementById('questions');
            let questionsHTML = '';
            const selectedChars = [];
            const categoryStats = {};

            // 初始化分类统计
            characterData.categories.forEach(category => {
                categoryStats[category.name] = { total: 0, correct: 0 };
            });

            // 从每个分类中随机选择至少 1 个字
            characterData.categories.forEach(category => {
                const chars = category.characters.sort(() => Math.random() - 0.5).slice(0, 1);
                selectedChars.push(...chars);
                categoryStats[category.name].total += chars.length;
            });

            // 补充剩余的字符，直到总数为 20
            while (selectedChars.length < 20) {
                const randomCategory = characterData.categories[Math.floor(Math.random() * characterData.categories.length)];
                const randomChar = randomCategory.characters[Math.floor(Math.random() * randomCategory.characters.length)];
                if (!selectedChars.includes(randomChar)) {
                    selectedChars.push(randomChar);
                    categoryStats[randomCategory.name].total++;
                }
            }

            // 打乱顺序
            selectedChars.sort(() => Math.random() - 0.5);

            // 保存选中的题目
            window.selectedChars = selectedChars;

            // 生成题目
            selectedChars.forEach((char, index) => {
                const [character, correctPinyin] = char.split(' ');
                const options = [correctPinyin];

                // 添加 3 个干扰项
                while (options.length < 4) {
                    const randomCategory = characterData.categories[Math.floor(Math.random() * characterData.categories.length)];
                    const randomChar = randomCategory.characters[Math.floor(Math.random() * randomCategory.characters.length)];
                    const [_, randomPinyin] = randomChar.split(' ');
                    if (!options.includes(randomPinyin)) {
                        options.push(randomPinyin);
                    }
                }

                // 打乱选项顺序
                options.sort(() => Math.random() - 0.5);

                questionsHTML += `
                    <div>
                        <p>${index + 1}. 请选择正确的拼音：${character}</p>
                        ${options.map(option => `
                            <label>
                                <input type="radio" name="q_${index}" value="${option}">
                                ${option}
                            </label>
                        `).join('')}
                    </div>
                `;
            });

            questionsDiv.innerHTML = questionsHTML;
        }

        // 提交表单并计算得分
        function submitTest() {
            let score = 0;
            const totalQuestions = 20;
            const form = document.getElementById('testForm');
            const categoryStats = {};

            // 初始化分类统计
            characterData.categories.forEach(category => {
                categoryStats[category.name] = { total: 0, correct: 0 };
            });

            Array.from(form.elements).forEach(element => {
                if (element.type === 'radio' && element.checked) {
                    const questionIndex = element.name.split('_')[1];
                    const [character, correctPinyin] = window.selectedChars[questionIndex].split(' ');
                    const category = getCategoryForCharacter(character); // 获取字符所属分类
                    categoryStats[category].total++;
                    if (element.value === correctPinyin) {
                        score++;
                        categoryStats[category].correct++;
                    }
                }
            });

            const accuracy = (score / totalQuestions) * 100;

            // 动态生成测试报告
            const report = generateReport(categoryStats, totalQuestions, score);

            // 显示测试报告
            document.getElementById('result').innerText = report;

            // 禁用提交按钮
            document.getElementById('submitButton').disabled = true;
        }

        // 根据字符获取所属分类
        function getCategoryForCharacter(character) {
            for (const category of characterData.categories) {
                if (category.characters.some(char => char.startsWith(character))) {
                    return category.name;
                }
            }
            return "未知分类";
        }

        // 生成个性化测试报告
        function generateReport(categoryStats, totalQuestions, correctCount) {
            const accuracy = (correctCount / totalQuestions) * 100;

            let report = `### 测试报告 🎉\n\n`;
            report += `**总题数：${totalQuestions}**\n`;
            report += `**正确题数：${correctCount}**\n`;
            report += `**正确率：${accuracy.toFixed(2)}%**\n\n`;

            // 根据正确率调整语气
            if (accuracy >= 80) {
                report += `太棒了！你的汉字识字能力非常出色！🎉\n`;
            } else if (accuracy >= 50) {
                report += `不错哦！你已经掌握了不少常用汉字，继续加油！💪\n`;
            } else {
                report += `别灰心！学习汉字是一个慢慢积累的过程，你已经迈出了重要的一步！🌟\n`;
            }

            // 分析分类表现
            report += `\n#### 你的强项 💪\n`;
            for (const [category, stats] of Object.entries(categoryStats)) {
                if (stats.total > 0 && stats.correct / stats.total >= 0.7) {
                    report += `- **${category}**：你在这个分类中表现很棒，答对了 ${stats.correct}/${stats.total} 题！\n`;
                }
            }

            report += `\n#### 需要加油的地方 💡\n`;
            for (const [category, stats] of Object.entries(categoryStats)) {
                if (stats.total > 0 && stats.correct / stats.total < 0.7) {
                    report += `- **${category}**：这个分类还需要多练习哦，答对了 ${stats.correct}/${stats.total} 题。\n`;
                }
            }

            // 提供学习建议
            report += `\n#### 学习小建议 🎯\n`;
            report += `- 复习这次测试中答错的题目，把那些汉字写一写、读一读。\n`;
            report += `- 每天学习一个分类，比如“自然现象类”可以结合天气观察来记忆。\n`;
            report += `- 找一些简单的短文或故事书来读，遇到不认识的字可以查一查。\n`;

            return report;
        }

        // 初始化页面
        window.onload = () => {
            generateQuestions();
        };
    </script>
</body
